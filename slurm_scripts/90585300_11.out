args:
Namespace(array_no='11', output_dir='/n/denic_lab/Lab/csth-output/lc3_wipi', ref_csv='/n/denic_lab/Users/nweir/python_packages/csth-imaging/im_list_wipi.csv')
czi path: /n/denic_lab/Lab/TH_Imaging/6.12.17 TH70_LC3-WIPI_LSM Airyscan 880/LC3-WIPI_HEK_wt_Torin_position15_AiryscanProcessing.czi
MultiFinder created.
background image added to MultiFinder.
CellSplitter instance created.
input image has 4 dimensions (multiple imgs)
segmenting image #1 of 1...
raw image imported.
performing gaussian filtering...
Image smoothed.
preprocessing complete.
thresholding...
mode = threshold.
thresholding complete.
filling holes in objects.
generating distance map...
distance map complete.
smoothing distance map...
distance map smoothed.
identifying maxima...
maxima identified.
watershedding...
watershedding complete.
creating PexSegmentObj...
passing segmented objs and seeds to Nuclei instance...

removing small perinuclear foci...
2 raw segmented DAPI foci
0 foci volume < 1000 px, removing...
removing nuclei_centers corresponding to perinuclear DAPI foci...
Nuclei segmented.
checking that nuclei have already been segmented...
generating cell masks...
log-transforming arrays...
applying gaussian filter...
computing p-value transformation...
 computing p-val xform for image 1 out of 1
converting to binary...

generating cell masks...

generating mask #1
labeling contiguous objects...
eliminating objects w/volume < 100,000 px...
pruning labels...
appending outputs...
mask #1 complete.

converting nuclei to binary masks for distance xform...
segmenting cells in image #1 out of 1...
performing Euclidean distance xform...
smoothing the distance map...
generating segmentation seeds from nuclei_centers...
watershed segmenting cells from nuclei centers...
segmentation complete for image #1.
removing cells that contact the edge of the image.
removing small foci...
2 raw segmented cells
0 foci volume < 1000 px, removing...

Cells segmented.
initializing attributes...
loading images...
Foci instance created.
beginning segmentation.
------------------------------------------------------
segmenting foci from channel 488
------------------------------------------------------
segmenting foci for position 1 out of 1
raw image imported.
performing gaussian filtering...
Image smoothed.
preprocessing complete.
generating distance map...
distance map complete.
smoothing distance map...
distance map smoothed.
identifying maxima...
maxima identified.
watershedding...
watershedding complete.
creating PexSegmentObj...
eliminating dim foci...
before eliminating dim foci: 176 foci in image
after eliminating dim foci: 154 foci in image
eliminating foci that reside outside of cells...
eliminating intranuclear foci...
138 final foci
foci segmented from position 1

------------------------------------------------------
segmentation complete for channel 488
------------------------------------------------------
------------------------------------------------------
segmenting foci from channel 561
------------------------------------------------------
segmenting foci for position 1 out of 1
raw image imported.
performing gaussian filtering...
Image smoothed.
preprocessing complete.
generating distance map...
distance map complete.
smoothing distance map...
distance map smoothed.
identifying maxima...
maxima identified.
watershedding...
watershedding complete.
creating PexSegmentObj...
eliminating dim foci...
before eliminating dim foci: 81 foci in image
after eliminating dim foci: 81 foci in image
eliminating foci that reside outside of cells...
eliminating intranuclear foci...
79 final foci
foci segmented from position 1

------------------------------------------------------
segmentation complete for channel 561
------------------------------------------------------
Foci segmented.
------------------------------------------------------
counting foci/cell in channel 488 images...
------------------------------------------------------
counting foci/cell in image #1 of 1
------------------------------------------------------
counting foci/cell in channel 561 images...
------------------------------------------------------
counting foci/cell in image #1 of 1
Foci counted.
n foci:
{0: array([61, 77])}
{0: array([33, 46])}
checking channels...
checking for overlap...
measuring overlap in channel 488
finding overlap in image #1out of 1
getting IDs of overlapping foci...
creating image of overlapping foci...
counting # of overlapping foci per cell...
overlap between channels measured.
outputting to csv...
initializing pd.DataFrame for output...
populating output arrays...
outputting images...
